---
phase: 03-homepage-hero
plan: 02
type: execute
wave: 2
depends_on: ['03-01']
files_modified:
  - app/components/home/Testimonials.vue
  - app/components/home/ExperienceTeaser.vue
  - app/components/home/SustainabilityTeaser.vue
  - app/components/home/LocationMap.vue
  - public/img/map/pension-location.webp
autonomous: false

must_haves:
  truths:
    - 'Testimonials carousel shows one testimonial at a time with star rating, auto-rotates, and supports swipe/arrows navigation'
    - 'Screen reader can navigate testimonials via keyboard; ARIA attributes present on carousel elements'
    - 'Experience teaser shows Barenpark as large hero card with 3 smaller cards; each has waldhonig distance badge'
    - 'Sustainability teaser shows 3 icon proof points (Solarenergie, Bio-Klaranlage, Kompost) with sage-tinted background'
    - 'Map section shows a static map image (no external requests, no cookies) with pension address and link to OpenStreetMap'
    - 'All homepage sections animate on scroll; prefers-reduced-motion disables all animations'
    - 'Complete homepage flows from hero through map section without broken layout or missing content'
  artifacts:
    - path: 'app/components/home/Testimonials.vue'
      provides: 'Embla carousel with autoplay, accessibility plugin, star ratings, sage background'
      min_lines: 60
    - path: 'app/components/home/ExperienceTeaser.vue'
      provides: 'Attraction grid with hero card + smaller cards, distance badges'
      min_lines: 40
    - path: 'app/components/home/SustainabilityTeaser.vue'
      provides: 'Statement-first layout with 3 icon proof points, sage-50 background'
      min_lines: 40
    - path: 'app/components/home/LocationMap.vue'
      provides: 'Static map image + address + directions info'
      min_lines: 30
    - path: 'public/img/map/pension-location.webp'
      provides: 'Pre-generated static map image of pension location'
  key_links:
    - from: 'app/components/home/Testimonials.vue'
      to: 'testimonials data'
      via: "queryCollection('testimonials') if app/data/testimonials.ts does NOT exist; otherwise import from app/data/testimonials.ts"
      pattern: '(queryCollection.*testimonials|import.*data/testimonials)'
    - from: 'app/components/home/Testimonials.vue'
      to: 'app/components/ui/StarRating.vue'
      via: 'Nuxt auto-import'
      pattern: 'StarRating'
    - from: 'app/components/home/Testimonials.vue'
      to: 'embla-carousel-vue'
      via: 'Composable import'
      pattern: 'useEmblaCarousel'
    - from: 'app/components/home/ExperienceTeaser.vue'
      to: 'attractions data'
      via: "queryCollection('attractions') if app/data/attractions.ts does NOT exist; otherwise import from app/data/attractions.ts"
      pattern: '(queryCollection.*attractions|import.*data/attractions)'
    - from: 'app/components/home/LocationMap.vue'
      to: 'public/img/map/pension-location.webp'
      via: 'NuxtImg src'
      pattern: 'img/map/pension-location'

user_setup:
  - service: geoapify
    why: 'One-time static map image generation (free tier, no account needed for URL-based generation)'
    env_vars: []
    dashboard_config:
      - task: 'If Geoapify requires an API key, create a free account at geoapify.com and get a key. Otherwise, use the direct screenshot approach.'
        location: 'geoapify.com/myprojects'
---

<objective>
Replace the 4 stub section components from Plan 03-01 with full implementations: Testimonials carousel, Experience/Attractions teaser, Sustainability teaser, and Location map. Complete the homepage.

Purpose: Delivers the remaining homepage sections that build trust (testimonials), inspire exploration (attractions), demonstrate values (sustainability), and provide practical information (map + address). Together with Plan 01's hero, welcome, and rooms sections, this completes the full homepage.

Output: Fully functional homepage with all 7 content sections, scroll animations, carousel, and static map. Ready for visual review.
</objective>

<execution_context>
@C:\Users\bernt\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\bernt\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-homepage-hero/03-CONTEXT.md
@.planning/phases/03-homepage-hero/03-RESEARCH.md
@.planning/phases/03-homepage-hero/03-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Testimonials carousel and Experience teaser components</name>
  <files>
    app/components/home/Testimonials.vue
    app/components/home/ExperienceTeaser.vue
  </files>
  <action>
    **1. Replace Testimonials stub** (`app/components/home/Testimonials.vue`) with full Embla carousel:

    **Data loading (adaptive -- check Plan 03-01 signal):**
    - FIRST check whether `app/data/testimonials.ts` exists (read the 03-01-SUMMARY.md or check the filesystem).
    - If `app/data/testimonials.ts` EXISTS: import testimonials from that TypeScript file directly (`import { testimonials } from '~/data/testimonials'`). No queryCollection needed.
    - If `app/data/testimonials.ts` does NOT exist: use Nuxt Content query: `const { data: testimonials } = await useAsyncData('testimonials', () => queryCollection('testimonials').all())`
    - Extract the items array from the response (structure depends on which path was taken)

    **Carousel setup:**
    ```typescript
    import useEmblaCarousel from 'embla-carousel-vue'
    import Autoplay from 'embla-carousel-autoplay'
    import Accessibility from 'embla-carousel-accessibility'

    const [emblaRef, emblaApi] = useEmblaCarousel(
      { loop: true, align: 'center' },
      [
        Autoplay({ delay: 6000, stopOnInteraction: true }),
        Accessibility(),
      ]
    )
    ```

    **IMPORTANT:** Wrap the carousel in `<ClientOnly>`. During SSR, render the first testimonial as static fallback content (no carousel, just the first quote + stars). This provides SEO value and graceful no-JS experience.

    **Layout:**
    - Full-bleed sage-tinted background (per CONTEXT.md: "Testimonials background: Sage-tinted full-bleed")
    - Use the existing sage palette: `bg-sage-50` or `bg-sage-100` as the full-bleed background
    - Section padding: `py-20 md:py-24`
    - H2: "Was unsere Gaeste sagen" -- centered, sage-900, `text-3xl md:text-4xl font-bold`
    - Container: `mx-auto max-w-4xl px-6` (narrower than other sections for reading comfort)

    **Carousel markup:**
    - Viewport: `overflow-hidden` div with `ref="emblaRef"`
    - Container: `flex` div inside viewport
    - Each slide: `flex-[0_0_100%] min-w-0` -- shows one testimonial at a time
    - Each testimonial card: centered text, quote in `text-lg md:text-xl text-sage-800 italic leading-relaxed`, `<StarRating :rating="testimonial.rating" />` below quote, name in `text-sage-600 font-semibold mt-4`
    - Quote marks: use CSS `::before` with a large decorative open-quote character or an Icon, in sage-200/300 for subtle decoration

    **Navigation:**
    - Prev/Next arrow buttons flanking the carousel (or below on mobile). Use `lucide:chevron-left` and `lucide:chevron-right`. Style: `size-10 rounded-full bg-white/80 shadow-sm hover:bg-white text-sage-700`. `aria-label="Vorheriges Zitat"` / `aria-label="Naechstes Zitat"`
    - Dot indicators below: small circles (active: sage-700, inactive: sage-300) showing current position. Use `emblaApi.scrollSnapList()` and `emblaApi.selectedScrollSnap()` for state

    **Accessibility:**
    - The Embla Accessibility plugin handles ARIA roles and screen reader announcements automatically
    - Ensure prev/next buttons have `aria-label`
    - Autoplay pauses on hover and on focus-within

    **2. Replace ExperienceTeaser stub** (`app/components/home/ExperienceTeaser.vue`) with full attraction grid:

    **Data loading (adaptive -- same approach as Testimonials):**
    - If `app/data/attractions.ts` EXISTS: import from TypeScript file
    - If it does NOT exist: use `queryCollection('attractions').all()` via Nuxt Content
    - Extract items array; find the featured attraction (Barenpark, `featured: true`) and the non-featured ones

    **Layout (per CONTEXT.md):**
    - White background section
    - H2: "Erleben Sie das Eichsfeld" -- sage-900, `text-3xl md:text-4xl font-bold`
    - Grid with hero attraction: 1 large card (Barenpark) + smaller cards for others
    - Desktop layout: `grid grid-cols-1 md:grid-cols-2 gap-6` where the hero card spans the first cell (larger) and smaller cards stack in the second cell as a sub-grid. Or: `grid grid-cols-1 md:grid-cols-3` where hero spans 2 columns (`md:col-span-2 md:row-span-2`)
    - Mobile: all cards stack vertically, hero card first

    **Card design:**
    - Each card: `rounded-lg overflow-hidden` with image and text overlay or image-above/text-below
    - Image: `<NuxtImg>` with `loading="lazy"`, `class="w-full h-48 md:h-full object-cover"` (hero card taller)
    - Distance badge (per CONTEXT.md): "Terracotta pill-shaped badge in top-right corner of each card photo, overlapping the image slightly. Shows '12 km' format"
      - `absolute top-3 right-3 bg-waldhonig-400 text-white text-sm font-semibold px-3 py-1 rounded-full`
    - Card text: attraction name as `h3`, short description, link to `/ausflugsziele/{slug}/`
    - Hero card: larger image area, more prominent text

    **CTA:**
    - Below the grid: "Alle Ausflugsziele entdecken" text link to `/ausflugsziele/` in sage-600, hover sage-700 with underline. Arrow: `&rarr;`
    - Or style as: `<NuxtLink to="/ausflugsziele/" class="text-sage-600 hover:text-sage-700 hover:underline font-semibold">Alle Ausflugsziele entdecken &rarr;</NuxtLink>`

    **Scroll animations:**
    - Wrap each attraction card in `<ScrollReveal :delay="index * 150">` for staggered entrance
    - Cap delay: `Math.min(index * 150, 400)` to prevent sluggish feel on later cards

    Section spacing: `py-20 md:py-24`, container `mx-auto max-w-6xl px-6`

  </action>
  <verify>
    - `make typecheck` passes
    - `make dev` shows Testimonials section with sage background, carousel arrows, star ratings, and rotating quotes
    - Clicking prev/next arrows cycles through testimonials
    - Keyboard Tab reaches carousel controls; Enter/Space activates them
    - ExperienceTeaser shows Barenpark as a larger card with distance badge; 3 smaller cards visible
    - Distance badges show "12 km", "18 km", etc. in waldhonig pills
    - Both sections fade in on scroll via ScrollReveal
  </verify>
  <done>
    Testimonials section displays an accessible Embla carousel with autoplay (6s interval), star ratings via StarRating component, prev/next arrows, dot indicators, sage-tinted full-bleed background, and SSR fallback showing first testimonial. ExperienceTeaser displays 4 attractions in a hero+grid layout with waldhonig distance badges and staggered scroll animations. Both load data adaptively: from TypeScript files if Plan 03-01 used the fallback path (signaled by presence of app/data/testimonials.ts), or from queryCollection if the Nuxt Content path worked.
  </done>
</task>

<task type="auto">
  <name>Task 2: Sustainability teaser, Location map, and static map image</name>
  <files>
    app/components/home/SustainabilityTeaser.vue
    app/components/home/LocationMap.vue
    public/img/map/pension-location.webp
  </files>
  <action>
    **1. Replace SustainabilityTeaser stub** (`app/components/home/SustainabilityTeaser.vue`):

    Follow CONTEXT.md decisions EXACTLY:

    **Background:** Sage-50 (#f4f7f3) full-bleed (per CONTEXT.md: "Sustainability background: Sage-50 full-bleed")

    **Structure (statement-first, evidence-second):**
    - H2: "Natuerlich nachhaltig" as actual `<h2>` tag -- `text-3xl md:text-4xl font-bold text-sage-900`, centered
    - Subtext (1-2 sentences): "Nachhaltigkeit ist bei uns kein Trend, sondern gelebter Alltag. Unser Zuhause im Eichsfeld pflegen wir mit derselben Sorgfalt wie Ihren Aufenthalt." -- `text-lg text-sage-700 max-w-2xl mx-auto text-center mt-4`
    - 3-column icon row below subtext (desktop), stacked vertically left-aligned on mobile

    **Three icon proof points (CONTEXT.md exact specs):**
    1. Solarenergie -- "Eigener Strom vom Dach" -- `lucide:sun`
    2. Bio-Klaranlage -- "Natuerliche Abwasserreinigung" -- `lucide:droplets`
    3. Kompost & Kreislauf -- "Gruenschnitt wird zu Gartenerde" -- `lucide:recycle`

    **Icon styling (CONTEXT.md):**
    - Thin-line style in sage-600 (`text-sage-600`)
    - Within subtle sage-100 circles: `flex items-center justify-center size-16 rounded-full bg-sage-100`
    - Icon size: `size-8` inside the 64px circle
    - Desktop: `grid grid-cols-3 gap-8` centered
    - Mobile: stacked vertically, left-aligned (`flex flex-col gap-6` with `flex-row items-center` per item)

    **Each proof point layout:**
    - Desktop: column layout (icon circle on top, h3 below, subtitle below)
    - Mobile: row layout (icon circle left, text right)
    - h3: `text-lg font-semibold text-sage-900`
    - Subtitle: `text-sage-700 mt-1`

    **CTA (CONTEXT.md exact specs):**
    - Text link ONLY (not a button): "Mehr ueber unsere Nachhaltigkeit erfahren" followed by arrow
    - `<NuxtLink to="/nachhaltigkeit/" class="text-sage-600 hover:text-sage-700 hover:underline font-semibold">Mehr ueber unsere Nachhaltigkeit erfahren &rarr;</NuxtLink>`
    - Centered below icon row, `mt-8`

    Section spacing: `py-20 md:py-24`, inner container `mx-auto max-w-4xl px-6`

    **2. Replace LocationMap stub** (`app/components/home/LocationMap.vue`):

    **Static map image:**
    - Generate or create a placeholder static map image at `public/img/map/pension-location.webp`
    - For the actual image: Try to use a Geoapify Static Maps API URL to download a map image. Example URL: `https://maps.geoapify.com/v1/staticmap?style=osm-bright&width=600&height=400&center=lonlat:10.2197,51.3747&zoom=13&marker=lonlat:10.2197,51.3747;color:%237A9B6D;size:large&apiKey=YOUR_FREE_KEY`
    - If API key is not available, create a placeholder: use `curl` or similar to download an OSM static map, or create a simple colored rectangle placeholder image (600x400px) with text "Karte wird geladen" that the user can replace later
    - Save as `public/img/map/pension-location.webp` (or `.png` and reference accordingly)

    **Component layout (per RESEARCH.md Pattern 4):**
    - H2: "So finden Sie uns" -- `text-3xl md:text-4xl font-bold text-sage-900`
    - Two-column grid on desktop: map image left, address + contact right
    - `grid grid-cols-1 md:grid-cols-2 gap-8`

    **Map image column:**
    - Wrap `<NuxtImg>` in an `<a>` link to OpenStreetMap: `href="https://www.openstreetmap.org/?mlat=51.3747&mlon=10.2197#map=14/51.3747/10.2197"` with `target="_blank" rel="noopener noreferrer"`
    - `<NuxtImg src="/img/map/pension-location.webp" alt="Karte mit Standort der Pension Volgenandt in Breitenbach, Eichsfeld" class="w-full rounded-lg" width="600" height="400" loading="lazy" />`
    - Below image: `<span class="text-sm text-sage-600 mt-2 block">Klicken fuer interaktive Karte auf OpenStreetMap</span>`
    - Hover effect on image: `group` class on link, `group-hover:scale-[1.02] transition-transform` on image

    **Address + contact column:**
    - `<address>` tag with `not-italic`:
      ```
      Pension Volgenandt
      Otto-Reuter-Strasse 28
      37327 Leinefelde-Worbis OT Breitenbach
      ```
    - Phone: `<a href="tel:+4936075189930">036075 / 189930</a>` with `lucide:phone` icon
    - Email: `<a href="mailto:info@pension-volgenandt.de">info@pension-volgenandt.de</a>` with `lucide:mail` icon
    - Style: `text-lg text-sage-800`, links with `text-sage-600 hover:text-sage-700 hover:underline`

    Section spacing: `py-20 md:py-24`, container `mx-auto max-w-6xl px-6`

    **IMPORTANT:** The phone number and email used here are examples based on PROJECT.md context. Verify against the actual pension contact details. The address is confirmed in PROJECT.md: "Otto-Reuter-Strasse 28, 37327 Leinefelde-Worbis OT Breitenbach".

  </action>
  <verify>
    - `make typecheck` passes
    - `make dev` shows Sustainability section with sage-50 background, 3 icon proof points, and text link CTA
    - LocationMap section shows map image (or placeholder) with address and contact links
    - Clicking the map image opens OpenStreetMap in a new tab
    - Phone link has `tel:` href, email link has `mailto:` href
    - No external network requests from the map section (verify in DevTools Network tab)
    - `make build` completes without errors
  </verify>
  <done>
    SustainabilityTeaser displays statement-first layout with H2 "Natuerlich nachhaltig", subtext, 3 icon proof points (sun, droplets, recycle) in sage-100 circles on sage-50 full-bleed background, and text link CTA to /nachhaltigkeit/. LocationMap shows static map image linked to OpenStreetMap, with full address, phone (tel: link), and email (mailto: link). Zero external requests from map section.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete homepage with all 7 sections: hero (video/poster with sage-charcoal fallback for missing media), welcome, featured rooms, testimonials carousel, experience teaser, sustainability teaser, and location map. Scroll-triggered animations on all sections. Responsive design (mobile + desktop).
  </what-built>
  <how-to-verify>
    1. Open `http://localhost:3000/` in browser (start dev server with `make dev` if not running)
    2. **Hero section:**
       - Desktop (>768px): Video area visible (may show poster if no video file), text "Pension Volgenandt" + "Ruhe finden im Eichsfeld" bottom-left, waldhonig CTA "Zimmer entdecken", bouncing scroll chevron
       - If video/poster files are not yet provided: hero should show sage-charcoal (#2C3E2D) background with gradient, text, and CTA still fully visible and styled correctly
       - Mobile (<768px, use DevTools): Poster image (or sage-charcoal fallback) fills viewport, CTA is full-width, text is readable against gradient
       - Entrance animation: text fades up in staggered sequence (H1, tagline, CTA, chevron)
    3. **Scroll down through all sections** -- each should fade in as it enters viewport:
       - Welcome: Greeting text + placeholder lifestyle photo
       - Featured Rooms: 3 room cards in grid (or message if no room data yet)
       - Testimonials: Carousel with arrows, star ratings, auto-rotating quotes, sage background
       - Experience: Barenpark large card + 3 smaller cards with waldhonig distance badges
       - Sustainability: Sage-50 background, 3 icon circles, "Mehr erfahren" link
       - Map: Static map image (or placeholder) + address + phone + email
    4. **Accessibility:** Open DevTools > Rendering > Emulate prefers-reduced-motion: reduce. Reload page. Verify NO animations play (no fade-ups, no carousel auto-rotation, no bounce on chevron)
    5. **No external map requests:** Open Network tab, scroll to map section. Confirm zero requests to openstreetmap.org or any tile server
    6. Click "Zimmer entdecken" CTA in hero -- should navigate to /zimmer/
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 3, or describe any issues to fix</resume-signal>
</task>

</tasks>

<verification>
1. `make typecheck` passes with zero errors
2. `make build` completes without errors -- all components resolve
3. Homepage at `/` displays all 7 sections in correct order: Hero, Welcome, FeaturedRooms, Testimonials, ExperienceTeaser, SustainabilityTeaser, LocationMap
4. Hero section renders gracefully even with missing video/poster assets (sage-charcoal background + gradient + text visible)
5. Testimonials carousel: autoplay works, arrows work, keyboard navigation works, star ratings display
6. All sections have scroll-triggered fade-in animations
7. `prefers-reduced-motion: reduce` disables ALL animations (hero entrance, scroll reveals, carousel autoplay, chevron bounce)
8. Mobile view: poster image (or fallback), no video, full-width CTA, stacked layouts, vertical icon column
9. Desktop view: video element, 3-col room grid, 2-col map layout, horizontal icon row
10. Network tab: zero external requests from map section; zero requests to openstreetmap.org
11. Page `<title>` is "Pension Volgenandt | Ruhe finden im Eichsfeld"
</verification>

<success_criteria>

- All 9 requirements covered: HOME-01 through HOME-08, DSGN-07
- Testimonials carousel accessible (ARIA, keyboard, screen reader)
- Experience teaser has hero card (Barenpark) with waldhonig distance badges
- Sustainability uses exact CONTEXT.md copy and icon choices
- Map is consent-free static image with no external data transmission
- All animations respect prefers-reduced-motion
- Homepage is visually complete and flows naturally from section to section
- Data loaded adaptively (queryCollection or TypeScript fallback) based on Plan 03-01 signal
  </success_criteria>

<output>
After completion, create `.planning/phases/03-homepage-hero/03-02-SUMMARY.md`
</output>
