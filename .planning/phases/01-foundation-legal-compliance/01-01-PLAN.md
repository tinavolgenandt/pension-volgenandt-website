---
phase: 01-foundation-legal-compliance
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - pnpm-lock.yaml
  - nuxt.config.ts
  - tsconfig.json
  - eslint.config.mjs
  - .prettierrc
  - .gitignore
  - Makefile
  - app/app.vue
  - app/app.config.ts
  - app/assets/css/main.css
autonomous: true

must_haves:
  truths:
    - 'pnpm install completes without errors and all dependencies are resolved'
    - 'make dev starts the Nuxt 4 dev server and displays a page at localhost:3000'
    - 'make lint, make format, and make typecheck all pass with zero errors'
    - 'No requests to googleapis.com or any external font CDN appear in the browser Network tab'
    - 'Tailwind utility classes (e.g. bg-sage-500, text-waldhonig-600, font-serif, font-sans) render correctly in the browser'
  artifacts:
    - path: 'package.json'
      provides: 'All dependencies declared'
      contains: 'nuxt'
    - path: 'nuxt.config.ts'
      provides: 'Nuxt 4 configuration with Tailwind v4 vite plugin, modules, TypeScript strict'
      contains: '@tailwindcss/vite'
    - path: 'app/assets/css/main.css'
      provides: 'Tailwind v4 @theme design tokens (sage palette, waldhonig palette, fonts, radii, breakpoints)'
      contains: '@theme'
    - path: 'Makefile'
      provides: 'Build commands: dev, build, preview, generate, lint, lint:fix, format, typecheck, clean'
      contains: 'typecheck'
    - path: 'eslint.config.mjs'
      provides: 'ESLint flat config via @nuxt/eslint withNuxt()'
      contains: 'withNuxt'
    - path: '.prettierrc'
      provides: 'Prettier config with tailwindcss plugin and tailwindStylesheet for v4'
      contains: 'tailwindStylesheet'
    - path: 'app/app.vue'
      provides: 'Root component with NuxtLayout and NuxtPage'
      contains: 'NuxtPage'
    - path: 'app/app.config.ts'
      provides: 'Runtime config with contact details, legal placeholders, nav items'
      contains: 'defineAppConfig'
  key_links:
    - from: 'nuxt.config.ts'
      to: 'app/assets/css/main.css'
      via: 'css array entry'
      pattern: "css:.*main\\.css"
    - from: 'nuxt.config.ts'
      to: '@tailwindcss/vite'
      via: 'vite.plugins'
      pattern: "tailwindcss\\(\\)"
    - from: '.prettierrc'
      to: 'app/assets/css/main.css'
      via: 'tailwindStylesheet option'
      pattern: 'tailwindStylesheet'
---

<objective>
Scaffold the Nuxt 4 project with all dependencies, configure Tailwind CSS v4 with the full design token system (sage green palette, waldhonig CTA palette, Lora + DM Sans variable fonts, spacing, radii), set up ESLint, Prettier, TypeScript strict mode, and the Makefile with all build commands.

Purpose: Establishes the complete build pipeline and design foundation that all subsequent plans depend on. After this plan, `make dev` works, `make lint` passes, and the design token system is ready for component development.

Output: A working Nuxt 4 project with zero-error toolchain, self-hosted variable fonts, and CSS-first Tailwind v4 design tokens.
</objective>

<execution_context>
@C:\Users\bernt\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\bernt\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-legal-compliance/01-CONTEXT.md
@.planning/phases/01-foundation-legal-compliance/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Nuxt 4 project and install all dependencies</name>
  <files>
    package.json
    pnpm-lock.yaml
    nuxt.config.ts
    tsconfig.json
    .gitignore
    app/app.vue
  </files>
  <action>
    Initialize a Nuxt 4 project in the current directory (which already has .planning/, static/, .gitignore, README.md).

    1. Run `pnpx nuxi@latest init . --force --packageManager pnpm` to scaffold Nuxt 4 into the existing directory. This creates package.json, nuxt.config.ts, tsconfig.json, app/app.vue, etc.

    2. Install all project dependencies:
    ```bash
    # Core (Tailwind v4 as dev dependency)
    pnpm add -D tailwindcss @tailwindcss/vite

    # Self-hosted variable fonts (runtime deps -- they provide font files)
    pnpm add @fontsource-variable/lora @fontsource-variable/dm-sans

    # Nuxt modules
    pnpm add @nuxt/fonts @nuxt/image @nuxt/eslint @vueuse/nuxt

    # Dev tooling
    pnpm add -D typescript vue-tsc prettier prettier-plugin-tailwindcss
    ```

    3. Update `.gitignore` to include Nuxt-specific ignores. Keep the existing `.playwright-mcp/` entry. Add:
    ```
    # Nuxt
    .nuxt/
    .output/
    node_modules/
    dist/

    # Environment
    .env
    .env.*
    !.env.example

    # IDE
    .vscode/
    .idea/
    *.sw?

    # OS
    .DS_Store
    Thumbs.db

    # Existing
    .playwright-mcp/
    ```

    4. Configure `nuxt.config.ts` with:
    - `compatibilityDate: '2025-07-15'`
    - `devtools: { enabled: true }`
    - `css: ['./app/assets/css/main.css']`
    - `modules: ['@nuxt/fonts', '@nuxt/image', '@nuxt/eslint', '@vueuse/nuxt']`
    - `vite: { plugins: [tailwindcss()] }` -- import tailwindcss from '@tailwindcss/vite' at top
    - `typescript: { strict: true, typeCheck: 'build' }`
    - `image: { format: ['avif', 'webp'], quality: 80 }`
    - `nitro: { prerender: { routes: ['/impressum', '/datenschutz', '/agb'] } }`
    - `app: { head: { htmlAttrs: { lang: 'de' }, title: 'Pension Volgenandt -- Ruhe finden im Eichsfeld', meta: [{ charset: 'utf-8' }, { name: 'viewport', content: 'width=device-width, initial-scale=1' }], link: [{ rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }] } }`

    Do NOT install or reference `@nuxtjs/tailwindcss` -- it conflicts with Tailwind v4.
    Do NOT create a tailwind.config.js or tailwind.config.ts -- Tailwind v4 is CSS-first only.

    5. Update `app/app.vue` to use NuxtLayout wrapping NuxtPage:
    ```vue
    <template>
      <NuxtLayout>
        <NuxtPage />
      </NuxtLayout>
    </template>
    ```

    6. Create a minimal `app/pages/index.vue` placeholder so the dev server has a page to render:
    ```vue
    <template>
      <div class="p-8">
        <h1 class="font-serif text-3xl font-bold text-sage-800">Pension Volgenandt</h1>
        <p class="mt-4 font-sans text-lg text-sage-600">Ruhe finden im Eichsfeld</p>
      </div>
    </template>
    ```
    This placeholder will be replaced in Phase 3 (homepage).

    7. Move existing `static/img/` contents to `public/img/` (Nuxt 4 uses `public/` not `static/`). Keep `static/` directory but empty. If `public/` does not exist, create it. Copy (do not delete originals yet) the 8 images.

  </action>
  <verify>
    Run `pnpm install` -- exits 0.
    Run `pnpm nuxi prepare` -- exits 0 (generates .nuxt/).
    Confirm `app/app.vue`, `nuxt.config.ts`, `package.json` all exist.
    Confirm `node_modules/nuxt/package.json` contains version ^4.
    Confirm no `@nuxtjs/tailwindcss` in package.json.
    Confirm no `tailwind.config.js` or `tailwind.config.ts` exists.
  </verify>
  <done>
    Nuxt 4 project scaffolded with all dependencies installed. nuxi prepare succeeds. All packages resolve without conflicts.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure design tokens, tooling, and app config</name>
  <files>
    app/assets/css/main.css
    app/app.config.ts
    eslint.config.mjs
    .prettierrc
    Makefile
  </files>
  <action>
    1. Create `app/assets/css/main.css` with Tailwind v4 @theme design tokens:
    ```css
    @import "tailwindcss";

    @theme {
      /* Typography */
      --font-serif: 'Lora Variable', Georgia, serif;
      --font-sans: 'DM Sans Variable', ui-sans-serif, system-ui, sans-serif;

      /* Sage green palette */
      --color-sage-50: oklch(0.97 0.01 145);
      --color-sage-100: oklch(0.94 0.02 145);
      --color-sage-200: oklch(0.88 0.04 145);
      --color-sage-300: oklch(0.80 0.06 145);
      --color-sage-400: oklch(0.70 0.08 145);
      --color-sage-500: oklch(0.60 0.09 145);
      --color-sage-600: oklch(0.50 0.08 145);
      --color-sage-700: oklch(0.42 0.07 145);
      --color-sage-800: oklch(0.34 0.06 145);
      --color-sage-900: oklch(0.26 0.05 145);
      --color-sage-950: oklch(0.18 0.04 145);

      /* Terracotta CTA palette */
      --color-waldhonig-50: oklch(0.97 0.02 45);
      --color-waldhonig-100: oklch(0.93 0.04 40);
      --color-waldhonig-200: oklch(0.86 0.08 38);
      --color-waldhonig-300: oklch(0.78 0.12 35);
      --color-waldhonig-400: oklch(0.70 0.14 30);
      --color-waldhonig-500: oklch(0.62 0.15 28);
      --color-waldhonig-600: oklch(0.55 0.14 25);
      --color-waldhonig-700: oklch(0.48 0.12 25);
      --color-waldhonig-800: oklch(0.40 0.10 25);
      --color-waldhonig-900: oklch(0.32 0.08 25);

      /* Warm backgrounds */
      --color-cream: oklch(0.97 0.01 85);
      --color-warm-white: oklch(0.99 0.005 85);

      /* Charcoal for header/footer dark backgrounds */
      --color-charcoal-800: oklch(0.28 0.01 240);
      --color-charcoal-900: oklch(0.22 0.01 240);
      --color-charcoal-950: oklch(0.16 0.01 240);

      /* Border radius -- 8px consistent per DSGN-01 */
      --radius-sm: 0.25rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;

      /* Custom breakpoints */
      --breakpoint-nav: 64rem;  /* 1024px -- mobile nav breakpoint */
    }

    /* Base typography: 18px body, 1.7 line-height, max 70ch per DSGN-05 */
    html {
      font-size: 18px;
    }

    body {
      font-family: var(--font-sans);
      line-height: 1.7;
      color: var(--color-sage-800);
      background-color: var(--color-warm-white);
    }

    /* Heading typography: Lora Variable serif per CONTEXT decisions */
    h1, h2, h3, h4, h5, h6 {
      font-family: var(--font-serif);
      line-height: 1.3;
    }

    h1 { font-weight: 700; }       /* Lora Bold */
    h2, h3 { font-weight: 600; }   /* Lora Semibold */

    /* Prose container for content pages */
    .prose-content {
      max-width: 70ch;
    }

    /* Focus visible for accessibility */
    :focus-visible {
      outline: 2px solid var(--color-waldhonig-500);
      outline-offset: 2px;
    }
    ```

    Note: Add charcoal palette for the dark header/footer "warm frame" effect described in CONTEXT. The sage-950 alone may not be dark enough for the grounding effect.

    2. Create `app/app.config.ts`:
    ```typescript
    export default defineAppConfig({
      siteName: 'Pension Volgenandt',
      siteTagline: 'Ruhe finden im Eichsfeld',
      contact: {
        phone: '+49 3605 542775',
        phoneDisplay: '03605 542775',
        mobile: '+49 160 97719112',
        mobileDisplay: '0160 97719112',
        email: 'kontakt@pension-volgenandt.de',
        address: {
          street: 'Otto-Reuter-Strasse 28',
          city: '37327 Leinefelde-Worbis OT Breitenbach',
          country: 'Deutschland',
        },
      },
      legal: {
        ownerName: '[INHABER_NAME]',
        taxId: '[STEUERNUMMER_ODER_UST_IDNR]',
        authority: '',
      },
      nav: [
        { label: 'Zimmer', to: '/zimmer' },
        { label: 'Familie', to: '/familie' },
        { label: 'Aktivitaeten', to: '/aktivitaeten' },
        { label: 'Nachhaltigkeit', to: '/nachhaltigkeit' },
        { label: 'Kontakt', to: '/kontakt' },
      ],
    })
    ```

    Use plain ASCII for nav labels (Aktivitaeten not Aktivitaeten with umlaut) because the page filenames use ASCII slugs. The display text in components can use proper umlauts.

    3. Create `eslint.config.mjs`:
    ```javascript
    import withNuxt from './.nuxt/eslint.config.mjs'

    export default withNuxt(
      {
        rules: {
          'vue/multi-word-component-names': 'off',
        },
      },
    )
    ```

    4. Create `.prettierrc`:
    ```json
    {
      "semi": false,
      "singleQuote": true,
      "trailingComma": "all",
      "printWidth": 100,
      "plugins": ["prettier-plugin-tailwindcss"],
      "tailwindStylesheet": "./app/assets/css/main.css"
    }
    ```

    5. Create `Makefile` with all required commands (FOUN-05):
    ```makefile
    .PHONY: dev build preview generate lint lint-fix format typecheck clean

    dev:
    	pnpm nuxi dev

    build:
    	pnpm nuxi build

    preview:
    	pnpm nuxi preview

    generate:
    	pnpm nuxi generate

    lint:
    	pnpm eslint .

    lint-fix:
    	pnpm eslint . --fix

    format:
    	pnpm prettier --write "app/**/*.{vue,ts,css,json}"

    typecheck:
    	pnpm nuxi typecheck

    clean:
    	rm -rf .nuxt .output node_modules/.cache
    ```

    Use `lint-fix` (hyphen, not colon) for Make compatibility. The roadmap says `lint:fix` but colons need escaping in Makefiles and are fragile on Windows. Use `lint-fix` and document in comments if needed.

  </action>
  <verify>
    Run `pnpm nuxi prepare` to generate .nuxt/ (needed for eslint config).
    Run `make dev` -- dev server starts on localhost:3000.
    Open browser, confirm the placeholder page renders with sage green text and Lora/DM Sans fonts.
    Open browser Network tab, confirm ZERO requests to googleapis.com or any external font CDN.
    Run `make lint` -- passes with 0 errors (warnings are OK).
    Run `make format` -- exits 0.
    Run `make typecheck` -- passes with 0 errors.
    Run `make build` -- build completes successfully.
  </verify>
  <done>
    Design tokens render correctly (sage, waldhonig colors visible; Lora serif headings, DM Sans body text). All make commands (dev, build, lint, format, typecheck) pass with zero errors. No external font CDN requests. The project is ready for component development.
  </done>
</task>

</tasks>

<verification>
1. `pnpm install && pnpm nuxi prepare` -- exits 0
2. `make dev` -- Nuxt dev server starts; localhost:3000 loads a page
3. `make lint` -- 0 errors
4. `make format` -- exits 0
5. `make typecheck` -- 0 errors
6. `make build` -- build completes
7. Browser: placeholder page shows sage-colored text with correct fonts
8. Browser Network tab: zero requests to googleapis.com or any external font domain
9. `grep -r "nuxtjs/tailwindcss" package.json` -- returns nothing (not installed)
10. `ls tailwind.config.*` -- no files found (CSS-first only)
</verification>

<success_criteria>

- All dependencies installed, Nuxt 4 dev server starts via `make dev`
- Tailwind v4 design tokens (sage-_, waldhonig-_, cream, warm-white, font-serif, font-sans) are usable in templates
- Lora Variable and DM Sans Variable fonts render correctly from local npm packages (zero CDN requests)
- ESLint, Prettier, and TypeScript strict mode all pass with zero errors
- Makefile provides all 9 commands: dev, build, preview, generate, lint, lint-fix, format, typecheck, clean
- app.config.ts contains contact details, legal placeholders, and nav items for use by layout components
  </success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-legal-compliance/01-01-SUMMARY.md`
</output>
