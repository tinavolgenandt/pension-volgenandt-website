# Phase 4.1: GitHub Pages Hosting & GitHub Actions CI/CD - Research

**Researched:** 2026-02-22
**Domain:** GitHub Pages deployment, GitHub Actions CI/CD, static site contact forms
**Confidence:** HIGH

## Summary

This phase migrates the Pension Volgenandt website from a hypothetical Netlify/Cloudflare Pages deployment to GitHub Pages with an automated GitHub Actions build pipeline. The site is already a fully static Nuxt 4 SSG project with all content pre-rendered, making it an ideal fit for GitHub Pages.

The deployment uses Nitro's `github_pages` preset via `npx nuxt build --preset github_pages`, which handles `.nojekyll` file creation, 404.html fallback generation, and outputs to `.output/public/`. The GitHub Actions workflow uses the official `actions/deploy-pages@v4` action. Since the site has a custom domain (`www.pension-volgenandt.de`), `baseURL` stays at `/` (no repository subpath needed) and a CNAME file must be placed in the static assets directory.

The contact form must switch from Netlify Forms to Formspree. Formspree's free tier provides 50 submissions/month with AJAX support, honeypot spam filtering, and works perfectly with static sites. The migration is minimal -- the existing Vue component's `handleSubmit` function just needs to POST to the Formspree endpoint instead of the Netlify Forms endpoint.

**Primary recommendation:** Use `npx nuxt build --preset github_pages` with pnpm caching in GitHub Actions, CNAME file in `app/public/` for custom domain, and Formspree free tier for the contact form.

## Standard Stack

The established libraries/tools for this domain:

### Core

| Tool                          | Version              | Purpose                    | Why Standard                                                        |
| ----------------------------- | -------------------- | -------------------------- | ------------------------------------------------------------------- |
| GitHub Actions                | v2 (workflow syntax) | CI/CD pipeline             | Native to GitHub, free for public repos, official Pages integration |
| actions/checkout              | v4                   | Repository checkout        | Official GitHub action                                              |
| pnpm/action-setup             | v4                   | pnpm installation          | Official pnpm action with built-in caching                          |
| actions/setup-node            | v4                   | Node.js setup              | Official action, supports pnpm cache via `cache: 'pnpm'`            |
| actions/upload-pages-artifact | v3                   | Artifact upload for Pages  | Official GitHub Pages artifact action                               |
| actions/deploy-pages          | v4                   | Deploy to GitHub Pages     | Official deployment action                                          |
| Nitro `github_pages` preset   | (built into Nuxt)    | Static output for GH Pages | Creates `.nojekyll`, `404.html`, proper output structure            |

### Supporting

| Tool      | Version   | Purpose              | When to Use                               |
| --------- | --------- | -------------------- | ----------------------------------------- |
| Formspree | Free tier | Contact form backend | Replaces Netlify Forms for static hosting |

### Alternatives Considered

| Instead of   | Could Use        | Tradeoff                                                                     |
| ------------ | ---------------- | ---------------------------------------------------------------------------- |
| Formspree    | Web3Forms        | Similar free tier (250/month) but less established                           |
| Formspree    | Getform          | Free tier only 50/month, similar to Formspree                                |
| Formspree    | Email.js         | Client-side only, exposes email credentials                                  |
| GitHub Pages | Cloudflare Pages | Better CDN/edge but more complex setup; GH Pages is simpler for this project |

**No installation needed for deployment** -- all configuration is via workflow YAML and Formspree account setup.

## Architecture Patterns

### Recommended Project Structure

```
.github/
  workflows/
    deploy.yml          # GitHub Actions workflow for build + deploy
app/
  public/
    CNAME               # Custom domain file (www.pension-volgenandt.de)
  components/
    contact/
      Form.vue          # Updated to use Formspree instead of Netlify Forms
```

### Pattern 1: GitHub Actions Build + Deploy Pipeline

**What:** Two-job workflow -- build job runs `nuxt build --preset github_pages`, deploy job pushes to GitHub Pages
**When to use:** Every push to `main` branch
**Example:**

```yaml
# Source: https://nuxt.com/deploy/github-pages + pnpm.io/continuous-integration
name: Deploy to GitHub Pages

on:
  workflow_dispatch:
  push:
    branches:
      - main

# Only allow one deployment at a time
concurrency:
  group: pages
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Install pnpm
        uses: pnpm/action-setup@v4
        with:
          version: 10

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'pnpm'

      - name: Install dependencies
        run: pnpm install

      - name: Build with github_pages preset
        run: pnpm nuxt build --preset github_pages

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./.output/public

  deploy:
    needs: build
    permissions:
      pages: write
      id-token: write
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

### Pattern 2: Formspree AJAX Submission (Vue 3)

**What:** Client-side form submission via fetch to Formspree endpoint
**When to use:** Contact form on `/kontakt/` page
**Example:**

```typescript
// Source: https://formspree.io + https://help.formspree.io/hc/en-us/articles/360013470814
async function handleSubmit() {
  isSubmitting.value = true
  errorMessage.value = ''

  try {
    const response = await fetch('https://formspree.io/f/YOUR_FORM_ID', {
      method: 'POST',
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        name: formData.name,
        email: formData.email,
        message: formData.message,
      }),
    })

    if (response.ok) {
      isSubmitted.value = true
    } else {
      const data = await response.json()
      if (data.errors) {
        errorMessage.value = data.errors.map((e: { message: string }) => e.message).join(', ')
      } else {
        errorMessage.value = 'Leider ist ein Fehler aufgetreten. Bitte versuchen Sie es erneut.'
      }
    }
  } catch {
    errorMessage.value =
      'Leider ist ein Fehler aufgetreten. Bitte versuchen Sie es erneut oder rufen Sie uns an.'
  } finally {
    isSubmitting.value = false
  }
}
```

### Pattern 3: CNAME File for Custom Domain

**What:** Static CNAME file in `app/public/` ensures custom domain persists across deployments
**When to use:** When using a custom domain with GitHub Pages
**Example:**

```
www.pension-volgenandt.de
```

Place this file at `app/public/CNAME` (no file extension). Nuxt copies everything from `app/public/` to the build output directory.

### Anti-Patterns to Avoid

- **Using `nuxt generate` instead of `nuxt build --preset github_pages`:** The `github_pages` preset automatically creates `.nojekyll` and `404.html` fallback. `nuxt generate` does NOT create `.nojekyll`, causing GitHub's Jekyll processing to break files in directories starting with underscore.
- **Hardcoding Formspree form ID in component code:** Store it in `app.config.ts` or a runtime config variable so it can be changed without modifying component code.
- **Setting `baseURL` to a repo subpath when using a custom domain:** With a custom domain, `baseURL` must be `/`. The repo subpath (`/pension-volgenandt-website/`) is only needed when serving from `username.github.io/repo-name/`.
- **Forgetting to configure GitHub Pages source as "GitHub Actions":** By default, GitHub Pages deploys from a branch. The workflow requires "GitHub Actions" as the source in Settings > Pages.

## Don't Hand-Roll

Problems that look simple but have existing solutions:

| Problem                         | Don't Build                   | Use Instead                               | Why                                                              |
| ------------------------------- | ----------------------------- | ----------------------------------------- | ---------------------------------------------------------------- |
| Static site deployment pipeline | Custom deploy scripts         | `actions/deploy-pages@v4`                 | Handles artifact upload, atomic deploys, environment URLs        |
| .nojekyll + 404 fallback        | Manual file creation in CI    | `github_pages` Nitro preset               | Preset handles all GitHub Pages quirks automatically             |
| Contact form backend            | Custom serverless function    | Formspree free tier                       | Spam filtering, email notifications, submission archive included |
| pnpm dependency caching         | Manual `actions/cache` setup  | `actions/setup-node` with `cache: 'pnpm'` | Built-in pnpm store caching via setup-node                       |
| SSL/HTTPS                       | Manual certificate management | GitHub Pages auto-provisioning            | Free Let's Encrypt certificates, auto-renewed                    |

**Key insight:** GitHub Pages + GitHub Actions is a zero-cost, zero-maintenance hosting solution for static sites. The official actions handle all deployment complexity. Formspree handles all form backend complexity. There is nothing to build -- only configuration.

## Common Pitfalls

### Pitfall 1: better-sqlite3 Native Module in CI

**What goes wrong:** `better-sqlite3` requires native compilation. On Ubuntu CI runners, this works via prebuilt binaries, but the `pnpm` config must explicitly allow build scripts.
**Why it happens:** The project has `better-sqlite3` in dependencies for `@nuxt/content`. The current `package.json` has a conflicting pnpm config with `better-sqlite3` in BOTH `onlyBuiltDependencies` AND `ignoredBuiltDependencies`.
**How to avoid:** Fix the pnpm config: keep `better-sqlite3` in `onlyBuiltDependencies` only (remove from `ignoredBuiltDependencies`). On Ubuntu CI, `better-sqlite3` prebuilt binaries install cleanly without build tools.
**Warning signs:** Build fails with "Could not locate the bindings file" or "better-sqlite3 module required."

### Pitfall 2: Windows-Only OXC Bindings in CI

**What goes wrong:** The `devDependencies` include Windows-specific packages (`@oxc-minify/binding-win32-x64-msvc`, `@oxc-parser/binding-win32-x64-msvc`, `@oxc-transform/binding-win32-x64-msvc`). These will fail to install on Ubuntu CI.
**Why it happens:** These were added for local Windows development but are platform-specific native modules.
**How to avoid:** pnpm handles optional platform dependencies correctly by default -- it skips packages that don't match the current OS. However, verify these packages have `os` fields in their `package.json` so pnpm knows to skip them on Linux. If they cause errors, use `pnpm install --ignore-scripts` or add them to `pnpm.overrides` with platform conditions.
**Warning signs:** CI install step fails with errors about win32 binaries.

### Pitfall 3: Missing .nojekyll File

**What goes wrong:** GitHub Pages runs Jekyll by default, which ignores files/directories starting with underscore (like `_nuxt/`). Without `.nojekyll`, all Nuxt assets return 404.
**Why it happens:** `nuxt generate` does NOT create `.nojekyll`. Only `nuxt build --preset github_pages` does.
**How to avoid:** Always use `npx nuxt build --preset github_pages` in the workflow, NOT `pnpm generate`.
**Warning signs:** Site loads but all CSS/JS assets return 404. Page appears as unstyled HTML.

### Pitfall 4: CNAME File Deleted on Deploy

**What goes wrong:** Each GitHub Pages deployment replaces all files. If CNAME is not in the build output, the custom domain configuration is lost.
**Why it happens:** CNAME file was configured manually via GitHub UI but not included in the build output.
**How to avoid:** Place `CNAME` file in `app/public/` directory. Nuxt copies `public/` contents to the output root. The file persists across all deployments.
**Warning signs:** Custom domain stops working after a deployment, reverts to `username.github.io/repo`.

### Pitfall 5: GitHub Pages Source Not Set to "GitHub Actions"

**What goes wrong:** The deploy workflow succeeds but the site shows the default GitHub Pages placeholder or nothing.
**Why it happens:** GitHub Pages defaults to deploying from a branch (e.g., `gh-pages`). The `actions/deploy-pages` workflow requires the source to be set to "GitHub Actions."
**How to avoid:** In the GitHub repository: Settings > Pages > Build and deployment > Source > select "GitHub Actions".
**Warning signs:** Workflow shows green checkmark but site is not updated.

### Pitfall 6: DNS Propagation and SSL Certificate Timing

**What goes wrong:** After configuring custom domain DNS, the site returns SSL errors or is unreachable.
**Why it happens:** DNS propagation takes time (up to 48 hours), and GitHub's Let's Encrypt certificate provisioning requires DNS to be fully propagated first.
**How to avoid:** Configure DNS records BEFORE the first deployment. Allow up to 24 hours for HTTPS to become available. If "Enforce HTTPS" checkbox is grayed out, wait or remove and re-add the custom domain.
**Warning signs:** Browser shows "certificate not valid" or "connection not secure."

### Pitfall 7: Formspree Form ID Exposed in Client Code

**What goes wrong:** The Formspree form ID is visible in the client-side JavaScript, which could be used by spam bots to submit to the form.
**Why it happens:** Static sites cannot hide API endpoints.
**How to avoid:** This is acceptable and expected for Formspree. Formspree provides server-side spam filtering (Formshield ML), honeypot fields (`_gotcha`), and optional reCAPTCHA. The form ID is designed to be public. Use the `_gotcha` honeypot field for additional protection.
**Warning signs:** Not a real warning -- this is by design. If spam becomes an issue, enable reCAPTCHA in Formspree dashboard.

## Code Examples

Verified patterns from official sources:

### Complete GitHub Actions Workflow (with pnpm)

```yaml
# Source: https://nuxt.com/deploy/github-pages + https://pnpm.io/continuous-integration
# File: .github/workflows/deploy.yml
name: Deploy to GitHub Pages

on:
  workflow_dispatch:
  push:
    branches:
      - main

concurrency:
  group: pages
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Install pnpm
        uses: pnpm/action-setup@v4
        with:
          version: 10

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'pnpm'

      - name: Install dependencies
        run: pnpm install

      - name: Build static site
        run: pnpm nuxt build --preset github_pages

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./.output/public

  deploy:
    needs: build
    permissions:
      pages: write
      id-token: write
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

### Formspree Contact Form (Vue 3 Composition API)

```vue
<!-- Source: https://formspree.io + community patterns -->
<script setup lang="ts">
const appConfig = useAppConfig()

const formData = reactive({
  name: '',
  email: '',
  message: '',
})

const isSubmitting = ref(false)
const isSubmitted = ref(false)
const errorMessage = ref('')

async function handleSubmit() {
  isSubmitting.value = true
  errorMessage.value = ''

  try {
    const response = await fetch(`https://formspree.io/f/${appConfig.formspreeId}`, {
      method: 'POST',
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        name: formData.name,
        email: formData.email,
        message: formData.message,
      }),
    })

    if (response.ok) {
      isSubmitted.value = true
    } else {
      const data = await response.json()
      if (data.errors) {
        errorMessage.value = data.errors.map((e: { message: string }) => e.message).join(', ')
      } else {
        errorMessage.value = 'Leider ist ein Fehler aufgetreten. Bitte versuchen Sie es erneut.'
      }
    }
  } catch {
    errorMessage.value =
      'Leider ist ein Fehler aufgetreten. Bitte versuchen Sie es erneut oder rufen Sie uns an.'
  } finally {
    isSubmitting.value = false
  }
}
</script>

<template>
  <!-- Success state (keep existing) -->
  <div v-if="isSubmitted" class="rounded-lg bg-sage-50 p-8 text-center">
    <!-- ... existing success UI ... -->
  </div>

  <!-- Form -->
  <form v-else @submit.prevent="handleSubmit">
    <!-- Formspree honeypot (hidden from users, catches bots) -->
    <input type="text" name="_gotcha" style="display: none" />

    <div class="space-y-6">
      <!-- ... existing form fields (no changes needed to inputs) ... -->

      <button type="submit" :disabled="isSubmitting">
        {{ isSubmitting ? 'Wird gesendet...' : 'Nachricht senden' }}
      </button>
    </div>
  </form>
</template>
```

### CNAME File

```
# File: app/public/CNAME
www.pension-volgenandt.de
```

### DNS Records for Custom Domain

```
# A records for apex domain (pension-volgenandt.de)
185.199.108.153
185.199.109.153
185.199.110.153
185.199.111.153

# CNAME record for www subdomain
www  CNAME  tinavolgenandt.github.io
```

### app.config.ts Addition

```typescript
// Add Formspree form ID to app config
export default defineAppConfig({
  // ... existing config ...
  formspreeId: 'xYOURFORMID', // Replace with actual Formspree form ID
})
```

## State of the Art

| Old Approach                    | Current Approach                          | When Changed  | Impact                                                 |
| ------------------------------- | ----------------------------------------- | ------------- | ------------------------------------------------------ |
| Deploy from `gh-pages` branch   | Deploy via GitHub Actions artifact        | 2022 (GA)     | No need for orphan branch; cleaner history             |
| `nuxt generate` for static      | `nuxt build --preset github_pages`        | Nuxt 3+       | Preset handles `.nojekyll`, 404 fallback automatically |
| Netlify Forms (host-dependent)  | Formspree (host-independent)              | N/A           | Works with any static host; 50 free submissions/month  |
| Manual CNAME file via GitHub UI | CNAME file in `public/` directory         | Best practice | Survives deployments; no manual reconfiguration        |
| Manual `actions/cache` for pnpm | `actions/setup-node` with `cache: 'pnpm'` | 2023+         | Simpler config, automatic cache management             |

**Deprecated/outdated:**

- `gh-pages` branch deployment pattern: Still works but `actions/deploy-pages` is the recommended approach
- Netlify Forms for this project: Will not work since hosting is moving to GitHub Pages
- `nuxt generate` for GitHub Pages: Use `nuxt build --preset github_pages` instead

## Open Questions

Things that couldn't be fully resolved:

1. **Formspree Form ID**
   - What we know: A Formspree account must be created and a form endpoint registered to get the form ID
   - What's unclear: The actual form ID (requires manual account creation at formspree.io)
   - Recommendation: Create the Formspree account and form during implementation. Use a placeholder ID in code that gets replaced with the real one. The owner or developer creates an account at formspree.io, creates a "Kontakt" form, and copies the form ID.

2. **DNS Configuration for Custom Domain**
   - What we know: The site URL is `www.pension-volgenandt.de`. DNS must point to GitHub Pages IPs (A records) and CNAME for www.
   - What's unclear: Current DNS provider and whether DNS changes can be made. The domain is currently on 1&1 IONOS.
   - Recommendation: Document the required DNS records. The actual DNS change happens at launch time (Phase 6), not in this phase. For now, the site can be tested at the GitHub Pages URL (`tinavolgenandt.github.io/pension-volgenandt-website`).

3. **Windows OXC Bindings in CI**
   - What we know: `@oxc-*` packages with `binding-win32-x64-msvc` are in devDependencies. These are platform-specific.
   - What's unclear: Whether pnpm on Ubuntu will silently skip these or error out.
   - Recommendation: These packages typically have `os` and `cpu` fields that tell pnpm to skip them on non-matching platforms. Test the CI workflow -- if it fails, either remove them from deps or add platform conditions. Most likely pnpm handles this correctly.

4. **better-sqlite3 pnpm Config Contradiction**
   - What we know: `package.json` currently has `better-sqlite3` in BOTH `onlyBuiltDependencies` and `ignoredBuiltDependencies` -- these are contradictory directives.
   - What's unclear: Which directive takes precedence.
   - Recommendation: Remove `better-sqlite3` from `ignoredBuiltDependencies`. Keep it only in `onlyBuiltDependencies` so the native bindings compile correctly on CI.

## Sources

### Primary (HIGH confidence)

- [Nuxt GitHub Pages Deployment Guide](https://nuxt.com/deploy/github-pages) -- official workflow YAML, preset name, baseURL guidance
- [Nitro GitHub Pages Preset](https://nitro.build/deploy/providers/github-pages) -- preset behavior, .nojekyll, 404.html
- [pnpm CI Documentation](https://pnpm.io/continuous-integration) -- pnpm/action-setup@v4, caching with setup-node
- [GitHub Pages Custom Domain Docs](https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site) -- DNS records, CNAME, HTTPS enforcement
- [GitHub Pages HTTPS Docs](https://docs.github.com/en/pages/getting-started-with-github-pages/securing-your-github-pages-site-with-https) -- Let's Encrypt auto-provisioning

### Secondary (MEDIUM confidence)

- [Formspree Plans Page](https://formspree.io/plans) -- free tier: 50 submissions/month, AJAX supported, unlimited forms
- [Formspree Homepage](https://formspree.io) -- endpoint format `https://formspree.io/f/{form_id}`, spam protection options
- [Formspree Honeypot Docs](https://help.formspree.io/hc/en-us/articles/360013580813-Honeypot-spam-filtering) -- `_gotcha` field, custom honeypot rules
- [Nuxt Content better-sqlite3 CI Issue](https://github.com/nuxt/content/issues/3483) -- pnpm `onlyBuiltDependencies` requirement

### Tertiary (LOW confidence)

- [Nuxt .nojekyll Issue #21232](https://github.com/nuxt/nuxt/issues/21232) -- confirmed .nojekyll works with `nuxt build` preset but NOT with `nuxt generate`
- Community blog posts on Nuxt + GitHub Pages deployment patterns

## Metadata

**Confidence breakdown:**

- Standard stack: HIGH -- official Nuxt docs, GitHub Actions docs, and pnpm docs all provide clear, current guidance
- Architecture: HIGH -- the workflow pattern is well-established and documented by Nuxt officially
- Pitfalls: HIGH -- identified from real GitHub issues and project-specific analysis (better-sqlite3 config, OXC bindings)
- Contact form migration: MEDIUM -- Formspree free tier verified, AJAX confirmed, but actual form ID requires manual account creation

**Research date:** 2026-02-22
**Valid until:** 2026-03-22 (stable domain -- GitHub Pages and Actions change slowly)
